<!DOCTYPE html>
<html lang="ru">
	<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5">
	<meta name="description" content="IT простым языком">
	<meta name="generator" content="HUGO">

	<meta name="theme-color" content="#ffffff">

    
    <link rel="stylesheet" href="/sass/main.min.2410c89c79b6e042a424a6cef6ba5cbff430844ddffbec9f142931da8c515642.css" integrity="sha256-JBDInHm24EKkJKbO9rpcv/QwhE3f&#43;&#43;yfFCkx2oxRVkI=">
    <title> IT простым языком </title>
</head>

<body>
	<div id="top"/>
<header>
    <div align="center">
        +---------------------------+<br>
        |.-------------------------.|<br>
        ||&nbsp;<a href="/">kee_reel@blog</a>:~$ cd&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||<br>
        ||&nbsp;<a href="/c">c</a>&nbsp;&nbsp;<a href="/cpp">c++</a>&nbsp;&nbsp;<a href="/python">python</a>&nbsp;&nbsp;<a href="/linux">linux</a>&nbsp;&nbsp;&nbsp;||<br>
        ||&nbsp;<a href="/opengl">opengl</a>&nbsp;&nbsp;<a href="/sql">sql</a>&nbsp;&nbsp;<a href="/network">networks</a>&nbsp;&nbsp;&nbsp;||<br>
        ||&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;||<br>
        ||&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="/about">обо_мне</a>&nbsp;||<br>
        |.-------------------------.|<br>
        +-::---------------------::-+<br>
        .---------------------------.<br>
        &nbsp;//&nbsp;/o<a href="/links">o</a>oooooooooooooooooooo\\&nbsp;\\&nbsp;<br>
        &nbsp;//&nbsp;/oooooooooooooooooooooooo\\&nbsp;\\&nbsp;<br>
        //-------------------------------\\<br>
        \\-------------------------------//<br>
    </div>
    <hr>
</header>

		
	<div id="wrapper">
		<div class="container">
			<section id="main_content">
    
    
    <h1>Компьютерные сети. Общение браузера с сервером</h1>
    
    
        <h3>Время чтения: 9 мин</h3>
    
    <p>Компьютерные сети насквозь пронизывают наше общество, я не буду описывать насколько важна их роль.</p>
<p>В этой статье я дам немного теории, а затем рассмотрю весь процесс общения браузера с сервером.</p>
<p>Давай разберёмся что такое сервер. У этого слова есть два значения: сервер-компьютер и сервер-программа.</p>
<h1 id="сервер-как-компьютер">Сервер как компьютер</h1>
<p><strong>Сервер</strong> &ndash; компьютер, с постоянным подключением к сети интернет и глобальным IP.</p>
<h3 id="ip-адрес">IP адрес</h3>
<p><strong>IP</strong> &ndash; адрес устройства в компьютерной сети.</p>
<p>IP состоит из 4-х чисел в промежутке от 0 до 255, разделённых точкой &ndash; например 188.134.65.58.</p>
<p>IP адрес может быть локальным и глобальным:</p>
<ul>
<li>
<p><strong>Локальный адрес</strong> выдаётся устройствам в пределах одной подсети (например твоя домашняя подсеть, к которой подключены твой телефон и компьютер).</p>
</li>
<li>
<p><strong>Глобальный адрес</strong> выдаётся интернет провайдером и доступен из любой точки  сети интернет.</p>
</li>
</ul>
<blockquote>
<p>Разница между локальным и глобальным адресом такая же, как разница между названием города с номером дома и номером квартиры. Если я скажу &ldquo;Санкт-Петербург, Советсткая 5&rdquo;, то ты поймёшь где это, а если я скажу &ldquo;квартира номер 17&rdquo; &ndash; ты не поймёшь в каком доме её искать.</p>
</blockquote>
<p>Для чего нужны локальные адреса? Почему нельзя всем выдать глобальные адреса?</p>
<p>Как я уже говорил, IP адрес состоит из 4 чисел от 0 до 255. Если перебрать все комбинации от 0.0.0.0 до 255.255.255.255, то получится всего 4,294,967,296 различных адресов, что не так уж и много, учитывая что сейчас у каждого есть телефон с доступом в интернет.</p>
<blockquote>
<p>Представь что за каждым глобальным адресом, кроется подсеть с множеством устройств с локальными адресами (прямо как номера квартир в разных домах).</p>
</blockquote>
<p>Глобальный адрес этого сервера 188.134.65.58 &ndash; попробуй скопировать его в адресную строку своего браузера, и посмотри что отобразится (браузер будет ругаться что это не безопасно, но всё ок).</p>
<p>Ты увидишь то же самое, что мог бы увидеть, введя в адресную cтроку &ldquo;kee-reel.com&rdquo;.</p>
<p>А что такое &ldquo;kee-reel.com&rdquo;? Это доменное имя.</p>
<h3 id="доменное-имя">Доменное имя</h3>
<p><strong>Доменное имя</strong> &ndash; строка связанная с определённым IP адресом. Обычно, доменное имя делают таким, чтобы человеку было легко его запомнить.</p>
<blockquote>
<p>Я купил своё доменное имя за примерно 500 рублей у провайдера <a href="http://www.godaddy.com">GoDaddy</a></p>
</blockquote>
<p>Когда ты пишешь &ldquo;kee-reel.com&rdquo;, твой браузер идёт на DNS сервер и переводит это доменное имя в глобальный IP адрес моего сервера &ndash; 188.134.65.58. После этого ты переходишь на сервер по этому IP.</p>
<p><strong>DNS сервер</strong> &ndash; сервер, единственная задача которого заключается в переводе доменных имён в IP адреса.</p>
<p><img src="/assets/images/network-client-to-server.png" alt="Браузер-сервер"></p>
<p>Если ты просто напишешь 188.134.65.58 в адресной строке браузера, то ты сразу пойдёшь на мой сервер, не заходя на DNS сервер.</p>
<h1 id="сервер-как-программа">Сервер как программа</h1>
<p><strong>Сервер</strong> &ndash; программа, которая может принимать и отправлять данные по сети от множества других программ. Например мой сервер, который выдаёт эти веб-страницы.</p>
<p>Она отличается от обычной программы тем, что с ней может одновременно взаимодействовать множество пользователей (от двух до миллионов).</p>
<p>Как происходит процесс взаимодействия?</p>
<p>У каждого пользователя есть программа, которая называется <strong>клиентом</strong>.</p>
<p><strong>Клиент</strong> &ndash; программа, которая принимает и отправляет данные на сервер, а также предоставляет пользовательский интерфейс. Например твой веб-браузер (обращается к разным серверам: kee-reel.com, google.com&hellip;) или мессенджер (различные мессенджеры обращаются к серверам своих создателей).</p>
<h1 id="общение-твоего-браузера-с-моим-сервером">Общение твоего браузера с моим сервером</h1>
<p>Твой браузер является клиентом, который общается с моим сервером. Давай на этом примере рассмотрим весь процесс общения между клиентом и сервером.</p>
<p>Сейчас будет много информации &ndash; не пытайся запомнить всё. Прочитай и запомни ключевые слова, а в дальнейшем можешь вернуться к ним и углубиться в их изучение.</p>
<h3 id="общение-тебя-и-браузера">Общение тебя и браузера</h3>
<p>Записывая &ldquo;<a href="https://kee-reel.com/network-web-server-ru%22">https://kee-reel.com/network-web-server-ru&quot;</a> в адресную строку своего браузера, ты говоришь браузеру:</p>
<ul>
<li>&ldquo;https://&rdquo; &ndash; используй протокол HTTPS (протокол безопасной передачи данных)</li>
<li>&ldquo;kee-reel.com&rdquo; &ndash; иди на сервер с таким доменным именем</li>
<li>&ldquo;/network-web-server-ru&rdquo; &ndash; скажи ему вот это</li>
</ul>
<h3 id="общение-браузера-с-операционной-системой">Общение браузера с операционной системой</h3>
<p><img src="/assets/images/network-browser-os.png" alt="Браузер-ОС"></p>
<p>Твой браузер сообщает операционной системе, что ему надо передать данные по адресу 188.134.65.58 (предположим, что браузер уже обратился к DNS серверу, и узнал IP адрес для домена &ldquo;kee-reel.com&rdquo;).</p>
<p>Операционная система соглашается и назначает браузеру случайный <strong>порт</strong> в промежутке от 49152 до 65535.</p>
<p><strong>Порт</strong> &ndash; это число, связанное с какой-то программой в рамках одного компьютера.</p>
<p>С помощью этого числа операционная система понимает какой программе перенаправлять данные из сети.</p>
<p>Порты в промежутке от 49152 до 65535 используются только при отправке запросов с клиента и выделяются динамически операционной системой.</p>
<p>Порты в промежутке от 1024 до 49152 могут использоваться различными серверами &ndash; например 6969 это порт используемый торрентом.</p>
<p>Порты в промежутке от 0 до 1023 используются стандартными протоколами на стороне сервера. Каждый порт связан с определённым протоколом:</p>
<ul>
<li>21 &ndash; FTP (протокол передачи данных)</li>
<li>22 &ndash; SSH (протокол удалённого доступа через консоль)</li>
<li>53 &ndash; DNS (протокол общения с DNS сервером)</li>
<li>80 &ndash; HTTP (протокол передачи веб страниц)</li>
<li>443 &ndash; HTTPS (безопасный протокол передачи веб страниц)</li>
</ul>
<p>Представим, что операционная система назначила твоему браузеру порт 51003 &ndash; в этот порт он получит ответ от сервера.</p>
<blockquote>
<p>Каждое приложение, запущенное на твоём компьютере, если хочет сделать запрос в интернет, получает от операционной системы случайный порт. Это необходимо для того, чтобы операционная система могла распределять данные, которые приходят по сети в разные приложения &ndash; данные с одним портом пойдут в браузер, со вторым в мессенджер, а с третьим в Spotify.</p>
</blockquote>
<p>Так как ты указал протокол HTTPS в запросе, браузер автоматически добавит порт 443 в адрес назначения: &ldquo;<a href="https://kee-reel.com:443/network-web-server-ru%22">https://kee-reel.com:443/network-web-server-ru&quot;</a></p>
<blockquote>
<p>Порты не являются жёстко заданными значениями &ndash; я мог бы поднять свой HTTPS сервер не на стандартном 443 порту, а на порту 1234 (просто какой-то порт). В этом случае тебе надо было бы самому указать порт назначения, так как браузер бы не смог автоматически его подставить: &ldquo;<a href="https://kee-reel.com:1234/network-web-server-ru%22">https://kee-reel.com:1234/network-web-server-ru&quot;</a></p>
</blockquote>
<blockquote>
<p>Ты можешь подробнее узнать как данные передаются между устройствами почитав про <a href="https://ru.wikipedia.org/wiki/%D0%A1%D0%B5%D1%82%D0%B5%D0%B2%D0%B0%D1%8F_%D0%BC%D0%BE%D0%B4%D0%B5%D0%BB%D1%8C_OSI">модель OSI</a></p>
</blockquote>
<h3 id="общение-компьютера-и-роутера">Общение компьютера и роутера</h3>
<p><img src="/assets/images/network-os-router.png" alt="ОС-Роутер"></p>
<p>Далее, операционная система берёт данные от браузера, и отправляет их роутеру через сетевую карту твоего компьютера (через кабель или WiFi антенну).</p>
<p>Роутер получает данные от компьютера, и запоминает по какому физическому порту пришли эти данные.</p>
<p><strong>Физический порт</strong> &ndash; физический разъём на роутере, к которому может быть подключено устройство. Обычно на роутере находится 4-6 физических портов (в них подключаются кабели).</p>
<h3 id="общение-роутера-и-интернет-провайдера">Общение роутера и интернет провайдера</h3>
<p>Роутер отправляет твой запрос интернет провайдеру. В запросе содержится:</p>
<ul>
<li>Адрес назначения (IP 188.134.65.58)</li>
<li>Порт назначения (порт 80)</li>
<li>Обратный адрес (IP адрес роутера в подсети провайдера)</li>
<li>Обратный порт (порт 51003, с которым операционная система связала браузер)</li>
<li>Данные (&quot;/network-web-server-ru&rdquo;)</li>
</ul>
<h3 id="путь-твоих-данных-по-сети-интернет">Путь твоих данных по сети интернет</h3>
<p><img src="/assets/images/network-router-internet.png" alt="Провайдеры"></p>
<p>Выходя из твоего роутера, данные проходят через инфраструктуру твоего провайдера. Существует 3 уровня провайдеров интернета:</p>
<ul>
<li>3-й уровень предоставляют услуги частным лицам в пределах городов и регионов (примеры: SkyNet, Дом.ru, Ростелеком)</li>
<li>2-й уровень связывают провайдеров 3-го уровня в пределах стран (примеры: Fiber Telecom, Мегафон, Ростелеком)</li>
<li>1-й уровень связывают провайдеров 2-го уровня между материками и владеют магистральными кабелями, проложенными по дну океана (примеры: AboveNet, AT&amp;T, Global Crossing)</li>
</ul>
<p><img src="/assets/images/network-tier-1-provider.png" alt="Провайдер 1-го уровня"></p>
<p>Если мы с тобой находимся в одном городе, то твои данные пройдут только через сети провайдера 3-го уровня. на одном материке &ndash; 2-го, а если мы на разных материках &ndash; 1-го уровня.</p>
<h3 id="общение-интернет-провайдера-и-моего-роутера">Общение интернет провайдера и моего роутера</h3>
<p>Пройдя через интернет, в мой роутер доходят твои данные. В данных записано, что они должны прийти в порт 443.</p>
<h3 id="общение-моего-роутера-и-сервера-компьютера">Общение моего роутера и сервера-компьютера</h3>
<p><img src="/assets/images/network-router-server.png" alt="Мой сервер"></p>
<p>На моём роутере создано правило &ldquo;если приходят данные в порт 443, то перенаправь их на компьютер с локальным адресом 192.168.1.101&rdquo;.</p>
<p>Локальный адрес 192.168.1.101 присвоен моему серверу-компьютеру &ndash; в этом качестве я использую Raspberry Pi 4. Можно использовать любой компьютер, но я использую такой именно такой, потому что он кушает 4 Вт электричества (плачу за это где-то 20 рублей в месяц).</p>
<p>Роутер перенаправляет данные моему серверу по заданному локальному IP адресу.</p>
<h3 id="общение-сервера-компьютера-и-сервера-программы">Общение сервера-компьютера и сервера-программы</h3>
<p><img src="/assets/images/network-server-nginx.png" alt="Сервер-Nginx"></p>
<p>Сервер-компьютер получает данные от роутера, и операционная система смотрит какой порт указан в данных.</p>
<p>Указан порт 443 &ndash; операционная система смотрит какая программа связана с портом 443. С этим портом связан сервер-программа Nginx.</p>
<p>Nginx, получая &ldquo;/network-web-server-ru&rdquo;, подготавливает данные для ответа твоему браузеру.</p>
<p>В ответе будет содержаться HTML текст этой страницы (текст страниц содержится в файлах, файлы лежат в папке blog). HTML выглядит как-то так:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;Записывая “https://kee-reel.com/network-web-server-ru” в адресную строку своего браузера, ты говоришь браузеру:&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">li</span>&gt;“https://” – используй протокол HTTPS (протокол безопасной передачи данных)&lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">li</span>&gt;“kee-reel.com” – иди на этот сервер&lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#f92672">li</span>&gt;“/network-web-server-ru” – скажи ему вот это&lt;/<span style="color:#f92672">li</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">ul</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">p</span>&gt;Мой сервер, получая “/network-web-server-ru”, отдаёт твоему браузеру HTML текст этой страницы. HTML выглядит как-то так:&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;language-html highlighter-rouge&#34;</span>&gt;&lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;highlight&#34;</span>&gt;&lt;<span style="color:#f92672">pre</span> <span style="color:#a6e22e">class</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;highlight&#34;</span>&gt;
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><p>Когда данные готовы, сервер меняет адрес назначения и обратный адрес местами &ndash; теперь данные пойдут в обратном направлении до твоего браузера.</p>
<h3 id="обратный-путь">Обратный путь</h3>
<p><img src="/assets/images/network-backtracking.png" alt="Обратный путь"></p>
<p>Мой сервер отправляет данные через мой роутер в интернет.</p>
<p>Твой роутер получает эти данные. Роутер смотрит на обратный адрес, и вспоминает &ndash; какой компьютер в локальной сети делал такой запрос? Твой компьютер!</p>
<p>Он отправляет данные в твой компьютер, он их получает, и операционная система смотрит на номер обратного порта &ndash; какая программа отправляла запрос с порта 51003? Твой браузер!</p>
<p>Получая эти данные, твой браузер размещает текст в нужных местах, отрисовывает картинки и закрашивает всё указанным цветом.</p>
<h1 id="ешё-один-пример">Ешё один пример</h1>
<p>Давай для закрепления рассмотрим ещё один пример &ndash; ты хочешь загуглить рецепт овсяного печенья.</p>
<p><img src="/assets/images/network-google.png" alt="Запрос в Google"></p>
<p>Ты пишешь в строке браузера &ldquo;рецепт овсяного печенья&rdquo;. Если у тебя поиском по-умолчанию в браузере выбран Google, то браузер переведёт твой текст в такой запрос:</p>
<pre tabindex="0"><code>https://google.com:443/?q=рецепт+овсяного+печенья
</code></pre><p>Браузер спросит у операционной системы &ndash; &ldquo;какой IP адрес соответствует google.com?&rdquo;.</p>
<p>Операционная система сходит на ближайший DNS сервер, узнает что этому домену соответствует IP 216.58.210.142 и вернёт этот IP браузеру.</p>
<p>Браузер обновит строку запроса:</p>
<pre tabindex="0"><code>https://216.58.210.142:443/?q=рецепт+овсяного+печенья
</code></pre><p>Браузер сформирует данные для отправки и впишет туда нужный адрес и порт назначения. После этого он передаст его операционной системе.</p>
<p>Операционная система выделит твоему браузеру порт 49983 и передаст данные сетеовй карте компьютера, а она передаст данные на подключеный роутер.</p>
<p>Роутер примет данные и отправит их в интернет.</p>
<p>Данные из интернета придут в роутер Google, и перенаправятся с него в их сервер.</p>
<p>На сервере они подберут из базы данных наиболее подходящие сайты под запрос &ldquo;рецепт овсяного печенья&rdquo;.</p>
<p>Когда список сайтов будет готов, они сформируют HTML страницу и отправят её обратно.</p>
<p>Данные пройдут их сервер и роутер, интернет, твой роутер и придут в твой компьютер.</p>
<p>Операционная система посмотрит что в данных указан порт 49983, и передаст их в твой браузер.</p>
<h1 id="практика">Практика</h1>
<p>Если ты знаешь Python, то в этой <a href="../web-server">статье</a> я показываю как создать простой сервер, который может отдавать HTML страницы.</p>
<p>Если не знаешь, то никогда не поздно его изучить &ndash; <a href="../intro">вот статья-введение</a>. Я пишу просто и интересно, тебе понравится!</p>
<h1 id="header-1заключение"><a href="#header-1"></a>Заключение</h1>
<p>Итого, мы изучили:</p>
<ul>
<li>Сервер &ndash; компьютер
<ul>
<li>IP (адрес в сети)</li>
<li>Локальный и глобальный IP (адреса устройств в подсети, общедоступные устройства)</li>
<li>Доменное имя (связывает глобальный IP с какой-то строкой)</li>
</ul>
</li>
<li>Сервер &ndash; программа
<ul>
<li>Работает сразу со множеством пользователей</li>
<li>Есть клиент, который с ним общается</li>
</ul>
</li>
<li>Взаимодействие клиента с сервером
<ul>
<li>Отправка запроса по адресу</li>
<li>Выделение порта операционной системой (порт это число позволяющее распределить данные из сети по разным программам)</li>
<li>Отправка данных роутеру в физический порт</li>
<li>Отправка данных интернет провайдеру</li>
<li>Прохождение данных по провайдерам различных уровней (3 &ndash; город/область, 2 &ndash; страны, 1 &ndash; континенты)</li>
<li>Получение данных роутером</li>
<li>Перенаправление данных серверу-компьютеру</li>
<li>Получение данных сервером-программой</li>
<li>Составление ответа клиенту</li>
<li>Обратный путь</li>
</ul>
</li>
</ul>
<p>Если что &ndash; пиши, я помогу и постараюсь объяснить лучше.</p>

    <hr>
    <div align="center">
        <a href="https://kee-reel.com/network/server/#top">▲ В начало ▲</a>
    </div>
    

			</section>
		</div>
	</div>

    <footer>
    <hr>
    <div align="center">
        Home server: Raspberry Pi 4<br>
        Temperature: 53<br>
Uptime: 1 hour, 7 minutes
    </div>
</footer>

</body>
</html>
